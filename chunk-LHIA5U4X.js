import{a as fe,b as ve,c as _e,d as Ve,e as he,f as be,g as Ce,h as ye,i as xe,j as Se,k as Ee,l as Ie,m as Me}from"./chunk-7IBU7OP4.js";import{$b as ee,A as V,Aa as R,B as k,Ba as G,Bb as y,Ca as q,Cb as x,Fb as J,G as g,Ha as W,I as s,L as E,O as o,P as r,Q as m,Sb as K,Tb as Q,U as b,Ub as X,V as u,W as c,Wb as Y,Yb as Z,Zb as f,ac as te,ca as p,cc as ie,d as L,da as C,dc as ae,e as h,ea as P,ec as re,fa as D,fc as oe,ga as N,h as w,ha as O,hc as ne,ia as j,ic as se,j as F,ja as U,jc as le,ka as I,kc as ce,la as M,lc as pe,m as v,n as _,nc as me,oa as T,oc as de,pa as z,pc as ge,qa as $,qc as ue,va as A,wa as B,xa as H,y as n}from"./chunk-ZOC74E5V.js";var S=class a{constructor(e){this.http=e}apiUrl=X.apiUrl+"/Vagas";getVagas(){return this.http.get(this.apiUrl).pipe(h(this.handleError))}getVagaPorId(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(h(this.handleError))}criarVaga(e){return this.http.post(this.apiUrl,e).pipe(h(this.handleError))}atualizarVaga(e,t){return this.http.put(`${this.apiUrl}/${e}`,t).pipe(h(this.handleError))}deletarVaga(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(h(this.handleError))}handleError(e){let t="Ocorreu um erro desconhecido!";if(e.error instanceof ErrorEvent)t=`Erro de cliente: ${e.error.message}`;else if(console.error(`Backend retornou c\xF3digo ${e.status}, corpo:`,e.error),e.status===400&&e.error)if(e.error.errors){let i=e.error.errors,l=[];for(let d in i)i.hasOwnProperty(d)&&l.push(i[d].join(" "));t=`Erro de valida\xE7\xE3o: ${l.join(" ")}`}else e.error.message?t=e.error.message:typeof e.error=="string"&&e.error.length<200?t=e.error:t=`Erro ${e.status}: Solicita\xE7\xE3o inv\xE1lida.`;else e.status===401?t="N\xE3o autorizado.":e.status===404?t="Recurso n\xE3o encontrado.":e.status===500?t="Erro interno do servidor.":e.message&&(t=e.message);return L(()=>new Error(t))}static \u0275fac=function(t){return new(t||a)(F(W))};static \u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})};var ke=()=>({width:"450px"}),Pe=()=>({width:"70vw","min-width":"400px","max-width":"750px"}),Te=a=>({"ng-invalid ng-dirty":a});function De(a,e){if(a&1){let t=b();o(0,"p-button",26),u("click",function(){v(t);let l=c();return _(l.abrirModalCriarVaga())}),r()}}function Ne(a,e){a&1&&(o(0,"div",27),m(1,"p-progressSpinner",28),r())}function Oe(a,e){if(a&1){let t=b();o(0,"div",29),m(1,"p-message",30),o(2,"div",31)(3,"p-button",32),u("click",function(){v(t);let l=c();return _(l.carregarVagas())}),r()()()}if(a&2){let t=c();n(),s("text",t.errorMessage)}}function je(a,e){if(a&1&&(o(0,"span",43),p(1),r()),a&2){let t=c().$implicit;n(),C(t.titulo)}}function Ue(a,e){a&1&&(o(0,"span",48),p(1,"|"),r())}function ze(a,e){a&1&&m(0,"i",49)}function $e(a,e){if(a&1&&(o(0,"div",44),m(1,"i",45),o(2,"span"),p(3),r(),g(4,Ue,2,0,"span",46)(5,ze,1,0,"i",47),o(6,"span"),p(7),r()()),a&2){let t=c().$implicit;n(3),C(t.empresa||"Empresa n\xE3o informada"),n(),s("ngIf",t.local),n(),s("ngIf",t.local),n(2),C(t.local)}}function Ae(a,e){if(a&1&&m(0,"p-tag",50),a&2){let t=c().$implicit,i=c(2);s("value",t.tipoContrato)("severity",i.getSeverityForTipoContrato(t.tipoContrato))}}function Be(a,e){if(a&1){let t=b();o(0,"p-button",56),u("click",function(){v(t);let l=c(2).$implicit,d=c(2);return _(d.realizarInscricao(l.id))}),r()}if(a&2){let t=c(4);s("loading",t.isSubmittingInscricaoVaga)}}function He(a,e){if(a&1){let t=b();o(0,"div",57)(1,"p-button",58),u("click",function(){v(t);let l=c(2).$implicit,d=c(2);return _(d.abrirModalCriarVaga(l))}),r(),o(2,"p-button",59),u("click",function(){v(t);let l=c(2).$implicit,d=c(2);return _(d.confirmarDelecaoVaga(l.id))}),r()()}}function Re(a,e){if(a&1&&(o(0,"div",51),m(1,"p-button",52),g(2,Be,1,1,"p-button",53),r(),g(3,He,3,0,"div",54),o(4,"div",55),p(5),T(6,"date"),r()),a&2){let t=c().$implicit,i=c(2);n(2),s("ngIf",i.canInscribeInVagas),n(),s("ngIf",i.canManageVagas),n(2),P(" Publicado em: ",z(6,3,t.dataPublicacao,"dd/MM/yyyy")," ")}}function Ge(a,e){if(a&1&&(o(0,"div",35)(1,"p-card",36),g(2,je,2,1,"ng-template",37)(3,$e,8,4,"ng-template",38),o(4,"p",39),p(5),T(6,"slice"),r(),o(7,"div",40),g(8,Ae,1,2,"p-tag",41),r(),g(9,Re,7,6,"ng-template",42),r()()),a&2){let t=e.$implicit;n(5),D(" ",$(6,3,t.descricao,0,150),"",t.descricao.length>150?"...":""," "),n(3),s("ngIf",t.tipoContrato)}}function qe(a,e){if(a&1&&(o(0,"div",33),g(1,Ge,10,7,"div",34),r()),a&2){let t=c();n(),s("ngForOf",t.vagas)}}function We(a,e){if(a&1){let t=b();o(0,"div",60),m(1,"i",61),o(2,"p",62),p(3," Nenhuma vaga encontrada no momento. "),r(),o(4,"p-button",63),u("click",function(){v(t);let l=c();return _(l.carregarVagas())}),r()()}}function Je(a,e){a&1&&(o(0,"small",64),p(1,"T\xEDtulo \xE9 obrigat\xF3rio."),r())}function Ke(a,e){a&1&&(o(0,"small",64),p(1,"T\xEDtulo deve ter no m\xEDnimo 5 caracteres."),r())}function Qe(a,e){a&1&&(o(0,"small",64),p(1,"Descri\xE7\xE3o \xE9 obrigat\xF3ria."),r())}function Xe(a,e){a&1&&(o(0,"small",64),p(1,"Descri\xE7\xE3o deve ter no m\xEDnimo 10 caracteres."),r())}var Le=class a{constructor(e,t,i,l,d,Ye){this.vagasService=e;this.inscricoesService=t;this.authService=i;this.fb=l;this.messageService=d;this.confirmationService=Ye;this.tiposContrato=[{label:"CLT",value:"CLT"},{label:"PJ (Pessoa Jur\xEDdica)",value:"PJ"},{label:"Est\xE1gio",value:"Est\xE1gio"},{label:"Tempor\xE1rio",value:"Tempor\xE1rio"},{label:"Freelance",value:"Freelance"},{label:"Outro",value:"Outro"}]}vagas=[];isLoading=!0;errorMessage=null;displayCriarVagaModal=!1;criarVagaForm;isSubmittingCriarVaga=!1;tiposContrato;currentUser=null;userSubscription;isEditModeVaga=!1;vagaParaEditarId=null;isSubmittingInscricaoVaga=!1;ngOnInit(){this.userSubscription=this.authService.currentUser.subscribe(e=>{this.currentUser=e}),this.carregarVagas(),this.criarVagaForm=this.fb.group({titulo:["",[f.required,f.minLength(5),f.maxLength(150)]],descricao:["",[f.required,f.minLength(10)]],empresa:["",[f.maxLength(100)]],local:["",[f.maxLength(100)]],tipoContrato:[null]})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}get canManageVagas(){return this.currentUser&&(this.currentUser.perfil==="empresa"||this.currentUser.perfil==="admin")}get canInscribeInVagas(){return this.currentUser&&this.currentUser.perfil!=="empresa"}carregarVagas(){this.isLoading=!0,this.errorMessage=null,this.vagasService.getVagas().subscribe({next:e=>{this.vagas=e,this.isLoading=!1},error:e=>{this.errorMessage=e.message||"N\xE3o foi poss\xEDvel carregar as vagas.",this.isLoading=!1}})}realizarInscricao(e){if(!this.currentUser||!this.currentUser.id){this.messageService.add({severity:"warn",summary:"Aten\xE7\xE3o",detail:"Voc\xEA precisa estar logado para se inscrever."});return}if(!this.canInscribeInVagas){this.messageService.add({severity:"warn",summary:"A\xE7\xE3o n\xE3o permitida",detail:"Utilizadores com perfil de empresa n\xE3o podem se inscrever em vagas."});return}this.isSubmittingInscricaoVaga=!0;let t={usuarioId:this.currentUser.id,vagaId:e,cursoId:null,status:"Pendente"};this.inscricoesService.criarInscricao(t).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:"Inscri\xE7\xE3o na vaga realizada com sucesso!"}),this.isSubmittingInscricaoVaga=!1},error:i=>{this.messageService.add({severity:"error",summary:"Erro na Inscri\xE7\xE3o",detail:i.message||"N\xE3o foi poss\xEDvel realizar a inscri\xE7\xE3o na vaga."}),this.isSubmittingInscricaoVaga=!1}})}abrirModalCriarVaga(e){this.isEditModeVaga=!!e,this.criarVagaForm.reset(),this.isEditModeVaga&&e?(this.vagaParaEditarId=e.id,this.criarVagaForm.patchValue({titulo:e.titulo,descricao:e.descricao,empresa:e.empresa,local:e.local,tipoContrato:e.tipoContrato})):this.vagaParaEditarId=null,this.displayCriarVagaModal=!0}fecharModalCriarVaga(){this.displayCriarVagaModal=!1,this.isSubmittingCriarVaga=!1,this.isEditModeVaga=!1,this.vagaParaEditarId=null}onSubmitCriarVaga(){if(this.criarVagaForm.invalid){this.messageService.add({severity:"warn",summary:"Aten\xE7\xE3o",detail:"Por favor, preencha todos os campos obrigat\xF3rios corretamente."}),Object.values(this.criarVagaForm.controls).forEach(t=>t.markAsTouched());return}this.isSubmittingCriarVaga=!0;let e=this.criarVagaForm.value;this.isEditModeVaga&&this.vagaParaEditarId?this.vagasService.atualizarVaga(this.vagaParaEditarId,e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:"Vaga atualizada com sucesso!"}),this.fecharModalCriarVaga(),this.carregarVagas()},error:t=>{this.messageService.add({severity:"error",summary:"Erro",detail:t.message||"N\xE3o foi poss\xEDvel atualizar a vaga."}),this.isSubmittingCriarVaga=!1}}):this.vagasService.criarVaga(e).subscribe({next:t=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:`Vaga "${t.titulo}" criada com sucesso!`}),this.fecharModalCriarVaga(),this.carregarVagas()},error:t=>{this.messageService.add({severity:"error",summary:"Erro",detail:t.message||"N\xE3o foi poss\xEDvel criar a vaga."}),this.isSubmittingCriarVaga=!1}})}confirmarDelecaoVaga(e){this.canManageVagas&&this.confirmationService.confirm({message:"Tem certeza que deseja excluir esta vaga? Esta a\xE7\xE3o n\xE3o pode ser desfeita.",header:"Confirmar Exclus\xE3o",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim, excluir",rejectLabel:"Cancelar",accept:()=>{this.deletarVaga(e)}})}deletarVaga(e){this.isLoading=!0,this.vagasService.deletarVaga(e).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Sucesso",detail:"Vaga exclu\xEDda com sucesso!"}),this.carregarVagas()},error:t=>{this.messageService.add({severity:"error",summary:"Erro ao Excluir",detail:t.message||"N\xE3o foi poss\xEDvel excluir a vaga."}),this.isLoading=!1}})}getSeverityForTipoContrato(e){if(!e)return"info";switch(e.toLowerCase()){case"clt":case"efetivo":return"success";case"pj":case"pessoa jur\xEDdica":return"warning";case"est\xE1gio":return"info";case"tempor\xE1rio":return"primary";default:return"secondary"}}get fCriarVaga(){return this.criarVagaForm.controls}static \u0275fac=function(t){return new(t||a)(V(S),V(Me),V(Y),V(oe),V(x),V(y))};static \u0275cmp=k({type:a,selectors:[["app-vagas-list"]],features:[U([x,y])],decls:41,vars:34,consts:[[1,"vagas-list-container","p-4"],[1,"flex","justify-content-between","align-items-center","mb-4"],[1,"text-2xl","font-bold","my-0"],["label","Criar Nova Vaga","icon","pi pi-plus",3,"click",4,"ngIf"],["class","flex justify-content-center align-items-center py-6",4,"ngIf"],["class","my-4",4,"ngIf"],["class","grid",4,"ngIf"],["class","text-center py-6",4,"ngIf"],[3,"visibleChange","onHide","header","visible","modal","draggable","resizable"],[3,"ngSubmit","formGroup"],[1,"p-fluid"],[1,"flex","flex-col","gap-2","mb-3"],["for","tituloVaga"],["pInputText","","id","tituloVaga","formControlName","titulo","type","text",3,"ngClass"],["class","p-error",4,"ngIf"],["for","descricaoVaga"],["pInputTextarea","","id","descricaoVaga","formControlName","descricao",3,"rows","autoResize","ngClass"],["for","empresaVaga"],["pInputText","","id","empresaVaga","formControlName","empresa","type","text"],["for","localVaga"],["pInputText","","id","localVaga","formControlName","local","type","text"],["for","tipoContratoVaga"],["id","tipoContratoVaga","formControlName","tipoContrato","placeholder","Selecione o tipo","optionLabel","label","optionValue","value",3,"options","showClear"],[1,"flex","justify-content-end","gap-2","mt-4"],["type","button","label","Cancelar","icon","pi pi-times","styleClass","p-button-text",3,"click"],["type","submit",3,"label","icon","loading"],["label","Criar Nova Vaga","icon","pi pi-plus",3,"click"],[1,"flex","justify-content-center","align-items-center","py-6"],["styleClass","w-8rem h-8rem","strokeWidth","4","animationDuration",".5s"],[1,"my-4"],["severity","error",3,"text"],[1,"mt-2","text-center"],["label","Tentar Novamente","icon","pi pi-refresh",3,"click"],[1,"grid"],["class","col-12 md:col-6 lg:col-4 xl:col-3 p-2",4,"ngFor","ngForOf"],[1,"col-12","md:col-6","lg:col-4","xl:col-3","p-2"],["styleClass","h-full flex flex-column"],["pTemplate","title"],["pTemplate","subtitle"],[1,"text-sm","text-gray-700","mb-3","flex-grow-1"],[1,"mb-3"],[3,"value","severity",4,"ngIf"],["pTemplate","footer"],[1,"text-xl","font-semibold"],[1,"flex","align-items-center","flex-wrap"],[1,"pi","pi-building","mr-2"],["class","mx-2",4,"ngIf"],["class","pi pi-map-marker mr-1",4,"ngIf"],[1,"mx-2"],[1,"pi","pi-map-marker","mr-1"],[3,"value","severity"],[1,"flex","justify-content-between","align-items-center","mb-2"],["label","Ver Detalhes","icon","pi pi-eye","styleClass","p-button-sm p-button-outlined"],["label","Inscrever-se","icon","pi pi-check","styleClass","p-button-sm p-button-success",3,"loading","click",4,"ngIf"],["class","flex justify-content-end gap-2",4,"ngIf"],[1,"text-xs","text-gray-500","mt-2","text-right"],["label","Inscrever-se","icon","pi pi-check","styleClass","p-button-sm p-button-success",3,"click","loading"],[1,"flex","justify-content-end","gap-2"],["icon","pi pi-pencil","styleClass","p-button-sm p-button-info p-button-outlined","pTooltip","Editar Vaga","tooltipPosition","top",3,"click"],["icon","pi pi-trash","styleClass","p-button-sm p-button-danger p-button-outlined","pTooltip","Deletar Vaga","tooltipPosition","top",3,"click"],[1,"text-center","py-6"],[1,"pi","pi-inbox","text-6xl","text-gray-400"],[1,"text-xl","text-gray-600","mt-3"],["label","Atualizar Lista","icon","pi pi-refresh","styleClass","mt-2",3,"click"],[1,"p-error"]],template:function(t,i){t&1&&(m(0,"p-toast")(1,"p-confirmDialog"),o(2,"div",0)(3,"div",1)(4,"h2",2),p(5,"Lista de Vagas Abertas"),r(),g(6,De,1,0,"p-button",3),r(),g(7,Ne,2,0,"div",4)(8,Oe,4,1,"div",5)(9,qe,2,1,"div",6)(10,We,5,0,"div",7),r(),o(11,"p-dialog",8),j("visibleChange",function(d){return O(i.displayCriarVagaModal,d)||(i.displayCriarVagaModal=d),d}),u("onHide",function(){return i.fecharModalCriarVaga()}),o(12,"form",9),u("ngSubmit",function(){return i.onSubmitCriarVaga()}),o(13,"div",10)(14,"div",11)(15,"label",12),p(16,"T\xEDtulo da Vaga"),r(),m(17,"input",13),g(18,Je,2,0,"small",14)(19,Ke,2,0,"small",14),r(),o(20,"div",11)(21,"label",15),p(22,"Descri\xE7\xE3o Completa"),r(),m(23,"textarea",16),g(24,Qe,2,0,"small",14)(25,Xe,2,0,"small",14),r(),o(26,"div",11)(27,"label",17),p(28,"Nome da Empresa (Opcional)"),r(),m(29,"input",18),r(),o(30,"div",11)(31,"label",19),p(32,"Local da Vaga (Ex: Fortaleza, CE ou Remoto)"),r(),m(33,"input",20),r(),o(34,"div",11)(35,"label",21),p(36,"Tipo de Contrato"),r(),m(37,"p-dropdown",22),r()(),o(38,"div",23)(39,"p-button",24),u("click",function(){return i.fecharModalCriarVaga()}),r(),m(40,"p-button",25),r()()()),t&2&&(n(),E(I(28,ke)),n(5),s("ngIf",i.canManageVagas),n(),s("ngIf",i.isLoading),n(),s("ngIf",!i.isLoading&&i.errorMessage),n(),s("ngIf",!i.isLoading&&!i.errorMessage&&i.vagas.length>0),n(),s("ngIf",!i.isLoading&&!i.errorMessage&&i.vagas.length===0),n(),E(I(29,Pe)),s("header",i.isEditModeVaga?"Editar Vaga":"Criar Nova Vaga"),N("visible",i.displayCriarVagaModal),s("modal",!0)("draggable",!1)("resizable",!1),n(),s("formGroup",i.criarVagaForm),n(5),s("ngClass",M(30,Te,i.fCriarVaga.titulo.touched&&i.fCriarVaga.titulo.errors)),n(),s("ngIf",i.fCriarVaga.titulo.touched&&(i.fCriarVaga.titulo.errors==null?null:i.fCriarVaga.titulo.errors.required)),n(),s("ngIf",i.fCriarVaga.titulo.touched&&(i.fCriarVaga.titulo.errors==null?null:i.fCriarVaga.titulo.errors.minlength)),n(4),s("rows",5)("autoResize",!0)("ngClass",M(32,Te,i.fCriarVaga.descricao.touched&&i.fCriarVaga.descricao.errors)),n(),s("ngIf",i.fCriarVaga.descricao.touched&&(i.fCriarVaga.descricao.errors==null?null:i.fCriarVaga.descricao.errors.required)),n(),s("ngIf",i.fCriarVaga.descricao.touched&&(i.fCriarVaga.descricao.errors==null?null:i.fCriarVaga.descricao.errors.minlength)),n(12),s("options",i.tiposContrato)("showClear",!0),n(3),s("label",i.isEditModeVaga?"Salvar Altera\xE7\xF5es":"Salvar Vaga")("icon",i.isEditModeVaga?"pi pi-save":"pi pi-plus-circle")("loading",i.isSubmittingCriarVaga))},dependencies:[q,A,B,H,G,R,ne,ie,Z,ee,te,ae,re,le,se,J,Q,K,ve,fe,Ve,_e,be,he,ye,Ce,pe,ce,Ie,Ee,ue,ge,de,me,Se,xe],styles:["[_nghost-%COMP%]     .p-card{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .p-card .p-card-body{display:flex;flex-direction:column;flex-grow:1;padding-bottom:2rem}[_nghost-%COMP%]     .p-card .p-card-content{flex-grow:1;padding-bottom:1rem}[_nghost-%COMP%]     .p-card .p-card-content .p-card-footer{margin-top:auto;padding-top:1rem;border-top:1px solid var(--surface-border)}[_nghost-%COMP%]     .p-card .p-card-content p{word-break:break-word}"]})};export{Le as VagasListComponent};
